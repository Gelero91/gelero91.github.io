<!--
DISCLAIMER :

Textures and artworks from RPG Maker VX, heavily modified.

You have my thanks,

Gwendal L.R.
-->
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, orientation=landscape">
  
  <title>Oasis (RC255)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <!--Cartes-->
  <script src="Maps.js"></script>

  <!--data (assets)-->
  <script src="Data.js"></script>

  <!--Sprites-->
  <script src="Sprites.js"></script>

  <!--Player-->
  <script src="Player.js"></script>

  <!--Item-->
  <script src="Item.js"></script>

  <!--Quest-->
  <script src="Quest.js"></script>
  
  <!--Spells-->
  <script src="Spell.js"></script>
  
  <!--Spells-->
  <script src="config.js"></script>

  <!--Moteur de jeux-->
  <script src="raycaster.js"></script>

  <meta charset="UTF-8">

  <link rel="stylesheet" href="index-style.css">


  <style>
    /*PIXEL FRAME*/
    /* Cadre pixelisé avec border-image */
    .pixel-frame {
      background-color: #200F09;
      box-sizing: border-box;
      
      /* Configuration du cadre avec border-image */
      border-width: 20px;
      border-style: solid;
      border-image-source: url('assets/pixelFrameTransparent.png');
      border-image-slice: 20; /* Valeur en pixels correspondant à l'épaisseur des coins */
      border-image-repeat: repeat; /* Préserve l'aspect pixelisé */
      image-rendering: pixelated;
    }

    .pixel-frame-noBorder {
      background-color: #200F09;
      box-sizing: border-box;
      
      /* Configuration du cadre avec border-image */
      border-style: solid;
      border-image-source: url('assets/pixelFrameTransparent.png');
      border-image-slice: 20; /* Valeur en pixels correspondant à l'épaisseur des coins */
      border-image-repeat: repeat; /* Préserve l'aspect pixelisé */
      image-rendering: pixelated;
    }

    .pixel-frame-item {
      background-color: #200F09;
      box-sizing: border-box;
      
      /* Configuration du cadre avec border-image */
      border-width: 20px;
      border-style: solid;
      border-image-source: url('assets/pixelFrame-Item.png');
      border-image-slice: 20; /* Valeur en pixels correspondant à l'épaisseur des coins */
      border-image-repeat: repeat; /* Préserve l'aspect pixelisé */
      image-rendering: pixelated;
    }

    /* Méthode avec cadre interne */
    .pixel-frame-internal {
      background-color: #333;
      box-sizing: border-box;
      position: relative;
      image-rendering: pixelated;
    }
    
    /* Création du cadre interne avec pseudo-élément */
    .pixel-frame-internal::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none; /* Permet d'interagir avec le contenu en dessous */
      border-width: 20px;
      border-style: solid;
      border-image-source: url('assets/pixelFrameTransparent.png');
      border-image-slice: 20;
      border-image-repeat: repeat;
      image-rendering: pixelated;
      box-sizing: border-box;
    }
  </style>

</head>

<body>
  
  <div class="landscape-message">
    Veuillez passer en mode paysage pour jouer.            
  </div>

  <!-- Textures -->
  <!--
    <img id="wallsimg" src="walls.png" alt="Walls" style="display: none">
    Base64 encoded images for floor and ceiling.
    This is to prevent "canvas has been tainted by cross-origin data" errors.
    -->

<!-- UX/UI - Start -->
<div>
  <div>
    <div class="paper">
      <div class="center">
        <!-- Fenêtre de rendu du jeu -->
        <div id="renderWindow"> 
          <div id="gameWindow" class="container pixel-frame" style="background-color: #200F09;">
            <!-- Zone écran principal (haut gauche) -->
            <div id="screen" class="game-area pixel-frame-internal">
              <canvas id="mainCanvas"></canvas>
              <img src="assets/game over.png" id="cinematicWindow" style="display: none;"></img>
            </div>
            
            <!-- Zone d'information (haut droite) -->
            <div id="infos" class="game-area">
              <div id="info">
                <h1>Alakir  </h1>
                <img src="assets/separatorLarge.png" alt="" class="separator"></img>
                <!-- PLAYER INFO OUTPUT, old -->
                <div id="playerInfoOutput" style="display: none;">
                  <p id="PlayerHPoutput">XXX</p>
                  <p class="text-center">/</p>
                  <p id="PlayerMaxHP">XXX</p>
                  <p class="text-bold"> HP </p>
                  <p id="PlayerMPoutput">YYY</p>
                  <p class="text-center">/</p>
                  <p id="PlayerMaxMP">YYY</p>
                  <p class="text-bold"> MP </p>
                  <p id="PlayerXPoutput">ZZZ</p>
                  <p class="text-center">/</p>
                  <p id="NextLevelXP">ZZZ</p>
                  <p class="text-bold"> XP </p>
                </div>
                <!-- PLAYER INFO PROGRESS BAR OUTPUT 
                 
                
                    <button id="button5" class="grid-item controlButton pixel-frame" style="background-color: #592918;height: 64px;
    width: 64px; border-radius: 0px;"><img src="assets/up.png" alt></button>
                -->
                <div>
                  <div class="progress-bar" id="hpBar">
                    
                    <div class="progress"></div><img class="icon" src="assets/icons/life.png" ></img>
                    <label style="top:50%;">Health</label>
                  </div>
                  <div class="progress-bar" id="mpBar">
                    <div class="progress"></div><img class="icon" src="assets/icons/energy.png">
                    <div class="progress"></div>
                    <label style="top:50%;">Mana</label>
                  </div>
                  
                  <img src="assets/separatorLarge.png" alt="" class="separator"></img>
                </br>

                  <div class="menu-button-container">
                    <button id="mainMenuButton" class="pixel-frame" style="margin-top: 9px;background-color: #582817;color: white;"><p style="margin-top: -7px;">MENU</p></button>
                  </div>

                  <div class="menu-button-container">
                    <button id="characterButton" class="pixel-frame" style="margin-top: 9px;
                    height: 30px;
                    width: 100%;
                    background-color: #582817;color: white;"><p style="margin-top: -7px;">CHARACTER</p></button>
                  </div>

                  <img src="assets/separatorLarge.png" alt="" class="separator" style="padding-top:  15px;"></img>

                  <div>
                    <p id="selectedSpell">-</p>
                  </div>
                  
                  <!--SPELLS xyz-->
                  <div id="SpellButtons">
                    <button id="previousSpell" class="controlButton pixel-frame" style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;">
                      <img src="assets/left.png" alt="" style="width: 150%; height: 150%; object-fit: contain;object-fit: contain;" ></img>
                    </button>

                    <div class="controlButton pixel-frame-item" style="height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;">
                    <img id="castSpell"  style="border-radius: 0px; background: none;width: 150%; height: 150%; object-fit: contain;"></img>
                    </div>

                    <button id="nextSpell" class="controlButton pixel-frame"
                    style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;">
                    <img src="assets/right.png" alt=""style="width: 150%; height: 150%; object-fit: contain;"></img>
                    </button>
                  </div>


                  <div class="progress-bar" id="xpBar" style="display:none;">
                    <i class="icon">★</i>
                    <div class="progress"></div>
                    <label>Experience</label>
                  </div>
                </div>
                <!--old progress bar-->
                <div id="old-progress-bar" style="display: none;">
                  <br>
                  <label>♥ Health</label>
                  <progress id="hpBarOld" value="x" max="x"></progress>
                  <br><br>
                  <label>❖ Mana</label>
                  <progress id="mpBarOld" value="y" max="y"></progress>
                  <br><br>
                  <br><br>
                  <label style="display:none;">★ Experience</label>
                  <progress id="xpBarOld" value="z" max="z" style="display:none;"></progress>
                </div>
                <div>
                  <!--compensation des boutons AB-->
                  <div style="display: none;">
                    <div id="joystickButtonABOld">
                      <!--
                      <button id="button7" class="grid-item controlButton">◄</button>
                      <button id="button8" class="grid-item controlButton">╬</button>
                      <button id="button9" class="grid-item controlButton">►</button>
                    -->
                    </div>
                  </div>
                  <!-- a modifier pour rendre utilisable-->
                  <div id="joystickButtonAB" style="display: none;">
                    <button id="button1" class="controlButton">A</button>
                    <div id="button2"></div>
                    <button id="button3" class="controlButton">B</button>
                  </div>
                </div>
              </div>
              
              <div id="stats">
                <h1>Stats</h1>
                <hr class="">
                <div class="stats-grid">
                  <p>Expe.</p>
                  <p>:</p>
                  <p>0</p>
                  <p>Level</p>
                  <p>:</p>
                  <p>1</p>
                  <p></p>
                  <p></p>
                  <p></p>
                </div>
              </div>
              
              <div id="equipment">
                <div style="display: none;">
                  <h1>EQUIPMENT</h1>
                  <hr>
                  <div class="equipment-grid">
                    <p>Hands :</p>
                    <span id="handsContent">EMPTY</span>
                    <p>Torso :</p>
                    <span id="torsoContent">EMPTY</span>
                    <br>
                  </div>
                </div>
                <h1>PLAYER STATS</h1>
                <div>
                  <div id="grid-container">
                    <div class="progress-bar" id="strengthBar">
                      <p class="progress-label" style="margin-top: 12px;">Strength</p>
                      <p id="PlayerStrOutput" style="margin-top: 12px;">x</p>
                      <div class="progress"></div>
                    </div>
                    
                    <div class="progress-bar" id="dexterityBar">
                      <p class="progress-label" style="margin-top: 12px;">Dexterity</p>
                      <p id="PlayerDexOutput" style="margin-top: 12px;">y</p>
                      <div class="progress"></div>
                    </div>
                    
                    <div class="progress-bar" id="intellectBar">
                      <p class="progress-label" style="margin-top: 12px;">Intellect</p>
                      <p id="PlayerIntOutput" style="margin-top: 12px;">z</p>
                      <div class="progress"></div>
                    </div>
                  </div>
                </div>
                <h1 style="margin-top: 14px;">COMBAT STATS</h1>
                <img src="assets/separatorLarge.png" alt="" class="separator"></img>
                <div class="combat-stats-grid-3">
                  <div>Might</div>
                  <div>:</div>
                  <div id="PlayerMightOutput">x</div>
                  <div>Magic</div>
                  <div>:</div>
                  <div id="PlayerMagicOutput">z</div>
                </div>
                <br>
                <img src="assets/separatorLarge.png" alt="" class="separator"></img>
                <div class="combat-stats-grid-4">
                  <div>Armor</div>
                  <div>:</div>
                  <div>-</div>
                  <div id="PlayerArmorOutput">a</div>
                  <div>Dodge</div>
                  <div>:</div>
                  <div>%</div>
                  <div id="PlayerDodgeOutput">b</div>
                  <div>Crit. </div>
                  <div>:</div>
                  <div>%</div>
                  <div id="PlayerCritiOutput">c</div>
                </div>
              </div>
              
              <!-- MAP -->
              <div id="minimapcontainer" class="border" style="display: none;">
                <canvas id="minimap"></canvas>
                <canvas id="minimapobjects"></canvas>
              </div>
            </div>
            
            <!-- Zone de sortie texte (bas gauche) -->
            <div id="output-area" class="game-area pixel-frame-internal">
              <!--CONSOLE-->
              <output id="output"></output>
              
              <!--FENETRE DIALOGUE-->
              <div id="dialogueWindow" class="underscreenDiv" style="display: none;">
                <div>
                  <!-- visage -->
                  <img id="faceOutput" src="" alt="No face error !">
                  <!-- dialogue et bouton -->
                  <div>
                    <div id="dialogue" style="width: 80%;"></div>
                    <button class="pixel-frame-item" id="nextButton">Next</button>
                  </div>
                </div>
              </div>              
              
<!--ITEMS-->
<div id="items" style="display: none; width: 654px; height: 100%+30px;">
  <div style="display: flex; justify-content: space-between; align-items: center; background-color: #331a0e; padding: 5px; border-bottom: 1px solid #663300; width:642px;">
    <div style="font-weight: bold; color: #e8d5a9;">ITEMS</div>
    <div><span class="stat-label">Gold:</span>
         <span id="PlayerGoldOutput" style="color: #ffcc00;">0</span> <span style="color: #ffcc00;">gp</span></div>
  </div>
  
  <div id="inventory-container" style="display: flex; height: calc(100% - 30px); width: 654px;">
    <!-- Liste des objets (40% de la largeur) -->
    <div id="inventory-list" style="width: 40%; height: 105%; border-right: 1px solid #663300; overflow-y: auto; padding-right: 5px;">
      <!-- Les items seront injectés ici par JS -->
    </div>
    
    <!-- Détails de l'objet sélectionné (60% de la largeur) -->
    <div id="item-details" style="width: 60%; height: 100%; display: flex; flex-direction: column;">
      <!-- Les détails de l'item seront injectés ici par JS -->
      <div id="item-details-placeholder" style="display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%; color: #8a7b6c;">
        <div>Select an item</div>
        <div>to view details</div>
      </div>
    </div>
  </div>
</div>
              
              <!--QUEST-->
<!--QUESTS-->
<div id="quests" style="display: none;">
  <div style="display: flex; justify-content: space-between; align-items: center; background-color: #331a0e; border-bottom: 1px solid #663300; width:642px;">
    <div style="font-weight: bold; color: #e8d5a9;">QUEST JOURNAL</div>
    <div id="quest-count" style="color: #e8d5a9;">-</div>
  </div>
  
  <div id="questContent" style="">
    > No quests in progress
  </div>
</div>
              
              <!--boutique-->
              <!--SHOP-->
              <div id="shop" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; background-color: #331a0e;
                border-bottom: 1px solid #663300; width:642px;">
                  <div id="shopName" style="font-weight: bold; color: #e8d5a9;">-</div>
                  <div><span class="stat-label">Gold:</span>
                      <span id="ShopPlayerGoldOutput" style="color: #ffcc00;">0</span> <span style="color: #ffcc00;">gp</span></div>
                </div>
                
                <div id="shopContent" style="">
                  > No items for sale
                </div>
              </div>
            </div>
            
            <!-- Zone de commandes (bas droite) - Carrée -->
            <div id="commands-area" class="game-area">
              <div id="commandcontainer">
                <!--JOYSTICK ABC-->
                <div style="display: none;">
                  <div id="joystick-container" class="joystick-container joystick-circle joystick-circle-shadow">
                    <div class="joystick" id="joystick">
                      <img style="position: relative; height: 100%; width:100%;" src="
                      data:image/png;base64,
                      iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAYAAABzwahEAAAAAXNSR0IArs4c6QAAAc5JREFUaEPtmr1NBDEQRtkeqIGQFpBogPREAVxAPQRHAYj0GkCiBUJqoAfQrTQEhtE3/hmvfd9ccoG9u/Pm2Wt7tMvFRr+7q8vv06OPn1/LFiFs8tATKB24AO9316vow+vH+t/bfHfjdOAa8FbmuxmnA0dDG7V7vfHdjSMw1D4duAaEQHrNeTfjdOAC/PJ2QHJN7fe3e5d1vrlxenCTzoxOrXd2bsYzmExdhwc3UQzQqbnxAZhMIQS4KU1n1CmMn5FME4rZuGxM5K6tlxdTtP90Ko0rwLWMp1tQr71zrXE5G1jjg8bpwNNj5c3D4yrFmtFSg7nXpWLen59M1VvVOB24VkDInUO55kr7a1MRVXL+GKcDR6Wi2YzLCNLM/xqnA0fl3dmXM41voQWXuUA31OnBUQJme6vHOq58eBBb1nTLSLdX1xIw2xxHFaI4j6PTUWltC923tr00Lmg8Xeboio21Zka73mx8tMBr4wnw2gzOdn0Yn81YbbzNjafram2AXstngLcyQ/+5F90HfqiSg0YWqpyg663tzec4PThKgJyXUXnbajC3n5txenCUgF5zOh0R7sbpwVECUI0sdw6j/t2M04OnCehtWp7f3fgo4D+5u09t98shNAAAAABJRU5ErkJggg==
                      "></img>
                    </div>
                  </div>
                </div>
                
                <div id="joystickBackButtonContainer" style="display:none;">
                  <button id="QuestButton" class="controlButton pixel-frame">Quest journal</button>
                  <button id="InventoryButton" class="controlButton pixel-frame" style="display:none;">Inventory</button>
                  <button id="joystickBackButton" class="controlButton pixel-frame" style="margin-top: 8px;">Back</button>
                </div>

                <!--CLAVIER-->
                <div id="actionButtons" style="display:block;">
                  <div class="grid-container">
                    <button id="buttonA"   class="grid-item controlButton pixel-frame" style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img src="assets/icons/action.png" style="width: 150%; height: 150%; object-fit: contain;" alt></button>

                    <div id="button2"  class="grid-item controlButton pixel-frame-item" style="height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img id="weaponIcon" src="assets/icons/sword.png" alt="weaponIcon" style="width: 200%; height: 200%; object-fit: contain;"/></div>


                    <button id="buttonB" class="grid-item controlButton pixel-frame" style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;">
                      <img src="assets/icons/spell.png" alt="spell" style="width: 150%; height: 150%; object-fit: contain;">
                  </button>


                    <button id="button4"   class="grid-item controlButton pixel-frame" style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img src="assets/left.png" 
                      style="
                      height: 150%;
                      width:  150%;
                      border-radius: 0px;"></button>


                    <button id="button5" class="grid-item controlButton pixel-frame" style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img src="assets/up.png"  style="height: 100%;
                    width:  150%; border-radius: 0px;"></button>


                    <button id="button6" class="grid-item controlButton pixel-frame" style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img src="assets/right.png"  
                    style="
                    height: 150%;
                    width:  150%;
                    border-radius: 0px;"></button>


                    <button id="button7" class="grid-item controlButton pixel-frame" style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img src="assets/left-left.png"  
                    style="
                    height: 150%; 
                    width:  150%;
                    border-radius: 0px;"
                    ></button>

                    <button id="button8" class="grid-item controlButton pixel-frame"style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img src="assets/down.png"  style="height: 100%;
                    width:  150%; border-radius: 0px;"></button>

                    <button id="button9" class="grid-item controlButton pixel-frame"style="background-color: #592918; height: 64px; width: 64px; position: relative; display: flex; justify-content: center; align-items: center; padding: 0;"><img src="assets/right-right.png"  
                    style="
                    height: 150%; 
                    width:  150%;
                    border-radius: 0px;"></button>
                  </div>
                </div>
              </div>
            </div>
          </div> 
        </div>

<div id="mainMenuWindow" style="display: none;">
  <div id="gameWindow" class="container pixel-frame" style="display: flex; padding: 0; width: 905px;height: 630px;">
    <!--xyz mznu-->    <img src="assets/menu.jpg" alt="" class="pixel-frame-noBorder" style="width: 515px;
    height: 590px">
    <div class="menuCenter" style="flex: 1; display: flex; flex-direction: column; justify-content: center; 
    ">
      <H1>OASIS.JS</H1>
      <br><!--changement des couleurs-->
      <button id="newGameButton" class="menuButton pixel-frame" style="background-color: #582817;color: white;">New Game</button>
      <br>
      <button id="loadButton" class="menuButton  pixel-frame" style="background-color: #582817;color: white;" >Load save</button>
      <br>
      <button id="saveButton" class="menuButton pixel-frame " style="background-color: #582817;color: white;">Save game</button>
      <br>
      <button id="nextMapButton" class="menuButton pixel-frame " style="background-color: #582817;color: white;">DEV TEST<br>*Next Map*</button>
      <br>
      <button id="backMenuButton" class="menuButton  pixel-frame" style="background-color: #582817;color: white;">Back to Game</button>
    </div>
  </div>
</div>


<div id="createCharacterWindow"  style="display : none;">
  <div style=" padding: 0; width: 905px;height: 100%;" class="pixel-frame">
    <div style="height: min-content;">
    <h2 style="text-align: center; color: #e8d5a9; font-family: 'Press Start 2P', cursive; font-size: 16px;">CREATE CHARACTER</h2>
  <br>
   <img src="assets/separatorLarge.png" alt="" class="separator" style="border: 40px; margin-left: 40%;"></img>  
  </div>
                   
    <div>
      <!-- Nom -->
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; font-size: 12px;">NAME:</label>
        <input type="text" id="characterName" class="pixel-frame-item" style="width: 100%; padding: 8px; background-color: #331a0e; color: #e8d5a9; border: none; font-family: 'Press Start 2P', cursive; font-size: 10px;" value="Alakir">
      </div>
      
      <!-- Image visage -->
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; font-size: 12px;">FACE:</label>
        <select id="characterFace" class="pixel-frame-item" style="width: 100%; padding: 8px; background-color: #331a0e; color: #e8d5a9; border: none; font-family: 'Press Start 2P', cursive; font-size: 10px;">
          <option value="PlayerFace">Default</option>
          <option value="PlayerFace2">Warrior</option>
          <option value="PlayerFace3">Mage</option>
          <option value="PlayerFace4">Rogue</option>
        </select>
      </div>
      
      <!-- Spécialité -->
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; font-size: 12px;">SPECIALIZATION:</label>
        <select id="characterSpecialization" class="pixel-frame-item" style="width: 100%; padding: 8px; background-color: #331a0e; color: #e8d5a9; border: none; font-family: 'Press Start 2P', cursive; font-size: 10px;">
          <option value="none">Balanced (+1 all)</option>
          <option value="strength">Strength (+3 Might)</option>
          <option value="dexterity">Dexterity (+10% Dodge/Crit)</option>
          <option value="magic">Magic (+3 Magic)</option>
        </select>
      </div>
      
      <!-- Arme -->
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; font-size: 12px;">STARTING WEAPON:</label>
        <select id="characterWeapon" class="pixel-frame-item" style="width: 100%; padding: 8px; background-color: #331a0e; color: #e8d5a9; border: none; font-family: 'Press Start 2P', cursive; font-size: 10px;">
          <option value="5">Club (+1 Might)</option>
          <option value="6">Staff (+1 Magic)</option>
          <option value="8">Dagger (+10% Dodge/Crit)</option>
        </select>
      </div>
      
      <!-- Armure -->
      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 5px; font-size: 12px;">STARTING ARMOR:</label>
        <select id="characterArmor" class="pixel-frame-item" style="width: 100%; padding: 8px; background-color: #331a0e; color: #e8d5a9; border: none; font-family: 'Press Start 2P', cursive; font-size: 10px;">
          <option value="2">Cape (+1 Armor)</option>
          <option value="4">Tunic (+1 Armor)</option>
          <option value="7">Armor (+3 Armor, -1 Dex)</option>
        </select>
      </div>
      
      <!-- Sorts -->
      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 5px; font-size: 12px;">STARTING SPELLS (Choose 2):</label>
        <div style="padding: 10px; background-color: #331a0e; border: 1px solid #663300;">
          <div style="margin-bottom: 10px;">
            <label style="cursor: pointer; display: flex; align-items: center; font-size: 10px;">
              <input type="checkbox" id="spell1" value="1" style="margin-right: 5px; cursor: pointer;">
              <span>Heal I - Restore 10+ HP (8 MP)</span>
            </label>
          </div>
          <div>
            <label style="cursor: pointer; display: flex; align-items: center; font-size: 10px;">
              <input type="checkbox" id="spell2" value="2" style="margin-right: 5px; cursor: pointer;">
              <span>Sparks - Electric damage (2 MP)</span>
            </label>
          </div>
          <div id="spellError" style="color: #ff6666; font-size: 9px; margin-top: 5px; display: none;">
            Please select exactly 2 spells
          </div>
        </div>
      </div>
        <div >
              <img src="assets/separatorLarge.png" alt="" class="separator" style="border: 40px; margin-left: 40%;"></img>  
        </div>
      <!-- Boutons -->
      <div style="display: flex; justify-content: space-between;">
        <button type="button" id="cancelCreation" class="pixel-frame" style="background-color: #582817; color: white; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 10px; cursor: pointer; margin: 20px;">CANCEL</button>
        <button type="button" id="createCharacter" class="pixel-frame" style="background-color: #582817; color: white; padding: 10px 20px; font-family: 'Press Start 2P', cursive; font-size: 10px; cursor: pointer; margin: 20px;">CREATE</button>
      </div>
    </div>  
  </div>
</div>



      </div>
    </div>
  </div>
</div>
<!-- UX/UI - End -->

<!--///////////////////////////////////////////////////
//  GAME ENGINE/RENDER WINDOW
////////////////////////////////////////////////////-->

  <script type="text/javascript">
    window.onload = function () {
      let raycaster = new Raycaster(document.getElementById("mainCanvas"))
      raycaster.gameCycle()
    }
    
/////////////////////////////////////////////////////
//  JOYSTICK
/////////////////////////////////////////////////////

  // Récupération des éléments HTML nécessaires
  const joystick = document.querySelector('.joystick');
  const container = document.querySelector('.joystick-container');

  let up = false;
  let down = false;
  let left = false;
  let right = false;

  // Variable pour ajuster l'écart d'angle entre les cadrans
  const angleOffset = 0.5; // Ajuster cette valeur selon les besoins (0.0 - 0.5)

  // Position centrale du joystick
  const centerPosX = container.offsetWidth / 2 - joystick.offsetWidth / 2;
  const centerPosY = container.offsetHeight / 2 - joystick.offsetHeight / 2;

  joystick.style.left = centerPosX + 'px';
  joystick.style.top = centerPosY + 'px';

  // Calcul de la distance maximale pour que le joystick touche presque la bordure du cercle
  const maxDistance = (container.offsetWidth - joystick.offsetWidth) / 2 - 5; // Ajuster "5" pour laisser un petit espace

  // Ajouter un écouteur de clic au conteneur pour gérer les clics sur les zones
  container.addEventListener('mousedown', handleJoystickClick);
  container.addEventListener('touchstart', handleJoystickClick);

  // Ajouter un écouteur pour détecter la fin du clic ou du toucher
  document.addEventListener('mouseup', resetJoystickPosition);
  document.addEventListener('touchend', resetJoystickPosition);

  // Ajouter un écouteur pour gérer les sorties du conteneur
  container.addEventListener('mouseleave', resetJoystickPosition);

  function handleJoystickClick(e) {
      // Empêcher le comportement par défaut du clic/toucher
      e.preventDefault();

      const boundingBox = container.getBoundingClientRect();
      const centerX = boundingBox.width / 2;
      const centerY = boundingBox.height / 2;

      const clickX = (e.clientX || e.touches[0].clientX) - boundingBox.left;
      const clickY = (e.clientY || e.touches[0].clientY) - boundingBox.top;

      const deltaX = clickX - centerX;
      const deltaY = clickY - centerY;

      // Calcul de l'angle du clic par rapport au centre
      const angle = Math.atan2(deltaY, deltaX);

      let offsetX = 0;
      let offsetY = 0;

      // Détermination de la direction en fonction de l'angle avec l'écart d'angle
      if (Math.abs(angle) < Math.PI / 2 - angleOffset) {
          // Clic dans la zone droite
          setDirection(false, false, false, true);
          offsetX = maxDistance;
      } else if (Math.abs(angle) > Math.PI / 2 + angleOffset) {
          // Clic dans la zone gauche
          setDirection(false, false, true, false);
          offsetX = -maxDistance;
      } else {
          // Clic dans la zone haut ou bas
          if (angle < 0) {
              setDirection(true, false, false, false); // Haut
              offsetY = -maxDistance;
          } else {
              setDirection(false, true, false, false); // Bas
              offsetY = maxDistance;
          }
      }

      // Déplacer le joystick vers la zone cliquée
      moveJoystick(offsetX, offsetY);
  }

  function moveJoystick(offsetX, offsetY) {
      // Enlever la transition pour le déplacement instantané
      joystick.style.transition = 'none';

      const newPosX = centerPosX + offsetX;
      const newPosY = centerPosY + offsetY;

      joystick.style.left = `${newPosX}px`;
      joystick.style.top = `${newPosY}px`;
  }

  function resetJoystickPosition() {
      // Réinitialiser toutes les directions
      setDirection(false, false, false, false);

      // Ajouter une transition pour adoucir le retour à la position centrale
      joystick.style.transition = 'left 0.3s ease, top 0.3s ease';

      // Ramener le joystick à sa position centrale
      joystick.style.left = `${centerPosX}px`;
      joystick.style.top = `${centerPosY}px`;
  }

  function setDirection(newUp, newDown, newLeft, newRight) {
      // Mettre à jour les variables de direction
      up = newUp;
      down = newDown;
      left = newLeft;
      right = newRight;

      // Déclencher un événement si la direction a changé
      triggerJoystickChangeEvent();
  }

  function triggerJoystickChangeEvent() {
      const joystickEvent = new CustomEvent('joystickchange', {
          detail: {
              up,
              down,
              left,
              right
          }
      });
      // console.log(joystickEvent);
      document.dispatchEvent(joystickEvent);
  }

    /////////////////////////////////////////////////////////
    //  END - JOYSTICK
    /////////////////////////////////////////////////////////
  </script>
</body>

